<!DOCTYPE html>
<html>

<head>
    <script src="/content/pages/dashboard/utils.js"></script>
</head>

<body>
    <div id="header">
        <div id="type">List</div>
        <div id="headerButtonDiv">
            <button onClick="switchPage('/content/pages/dashboard/admin/tracker/events/create.html')">Create New</button>
        </div>
    </div>
    <div id="tableDiv">
        <table id="table">
            <tr>
                <th><input type="checkbox" item="all" /></th>
                <th>Name</th>
                <th>Short</th>
                <th>Charity</th>
                <th>Target</th>
                <th>Start Time</th>
                <th>End Time</th>
                <th>Visible</th>
                <th>State</th>
                <th></th>
            </tr>
        </table>
    </div>
    <script>
        GET('events/all', (err, data) => {
            if (err) return;
            let table = document.getElementById('table');
            data.data.forEach(event => {
                let startTime = new Date(event.startTime);
                startTimeHours = (startTime.getHours() < 10) ? '0' + startTime.getHours() : '' + startTime.getHours();
                startTimeMins = (startTime.getMinutes() < 10) ? '0' + startTime.getMinutes() : '' + startTime.getMinutes();
                startTime = `${startTime.getDate()}/${startTime.getMonth() + 1}/${startTime.getFullYear()} ${startTimeHours}:${startTimeMins}`

                let endTime = new Date(event.endTime);
                endTimeHours = (endTime.getHours() < 10) ? '0' + endTime.getHours() : '' + endTime.getHours();
                endTimeMins = (endTime.getMinutes() < 10) ? '0' + endTime.getMinutes() : '' + endTime.getMinutes();
                endTime = `${endTime.getDate()}/${endTime.getMonth() + 1}/${endTime.getFullYear()} ${endTimeHours}:${endTimeMins} `

                let row = table.insertRow();
                row.insertCell().innerHTML = `<input type="checkbox" item="${event.id}" />`;
                row.insertCell().innerHTML = `<p class="tableText">${event.name}</p>`;
                row.insertCell().innerHTML = `<p class="tableText">${event.short}</p>`;
                row.insertCell().innerHTML = `<p class="tableText">${event.charityName}</p>`;
                row.insertCell().innerHTML = `<p class="tableText">${event.targetAmount}</p>`;
                row.insertCell().innerHTML = `<p class="tableText">${startTime}</p>`;
                row.insertCell().innerHTML = `<p class="tableText">${endTime}</p>`;
                row.insertCell().innerHTML = `<p class="tableText">${event.visible}</p>`;
                row.insertCell().innerHTML = `<p class="tableText">${event.state}</p>`;
            })
        });

        window.addEventListener("message", (event) => {

        }, false);
    </script>
    <style>
        body {
            width: 100% - 17px;
            height: 100%;
            overflow-y: hidden;
        }

        #header {
            display: flex;
            justify-content: space-between;
        }

        #tableDiv {
            background-color: #FFFFFF;
            margin: 24px;
        }

        table {}

        th,
        td {
            border-bottom: 1px solid #F6F7FB;
        }
    </style>
</body>

</html>